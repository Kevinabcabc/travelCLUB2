{"version":3,"sources":["pages/ReleaseTravel/NewTravel/children/ImgLoader/ImgLoader.js","pages/ReleaseTravel/NewTravel/NewTravel.js","pages/common/HeaderBack/HeaderBack.js"],"names":["ImgLoader","state","files","multiple","onChange","type","index","console","log","setState","onSegChange","e","nativeEvent","selectedSegmentIndex","this","length","onImageClick","fs","selectable","Component","timestampToTime","timestamp","dateObj","Date","getFullYear","getMonth","getDate","alert","showAlert","title","content","text","onPress","style","nowTimeStamp","now","jonners","name","img","id","Math","floor","random","viewNum","joinerNum","commentNum","NewTravel","props","date","imgLoader","autoFocusInst","value","customFocusInst","addNewTravel","username","userInfo","userImg","releaseTime","Number","url","views","numOfJoin","joiner","slice","history","goBack","className","HeaderBack","ref","el","getImgUrl","placeholder","data-seed","autoHeight","rows","count","minDate","mode","Item","arrow","onClick","SmtAction","bind","connect","user","dispatch","data","src","alt"],"mappings":"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","file":"static/js/14.5c7961ef.chunk.js","sourcesContent":["import React, { Component } from 'react';\r\nimport { ImagePicker, WingBlank } from 'antd-mobile';\r\n\r\n  \r\nexport class ImgLoader extends Component {\r\n\r\n    state = {\r\n        files: [],\r\n        multiple: false,\r\n      }\r\n\r\n      onChange = (files, type, index) => {\r\n        console.log(files, type, index);\r\n        this.setState({\r\n          files,\r\n        });\r\n      }\r\n      onSegChange = (e) => {\r\n        const index = e.nativeEvent.selectedSegmentIndex;\r\n        this.setState({\r\n          multiple: index === 1,\r\n        });\r\n      }\r\n      \r\n      render() {\r\n        const { files } = this.state;\r\n        return (\r\n          <WingBlank>\r\n            <ImagePicker\r\n              files={files}\r\n              length={1}\r\n              onChange={this.onChange}\r\n              onImageClick={(index, fs) => console.log(index, fs)}\r\n              selectable={files.length < 1}\r\n              multiple={this.state.multiple}\r\n            />\r\n          </WingBlank>\r\n        );\r\n      }\r\n}\r\n\r\nexport default ImgLoader;\r\n\r\n\r\n\r\n","import React, { Component } from 'react';\r\nimport './style.scss'\r\nimport HeaderBack from '../../common/HeaderBack/HeaderBack'\r\nimport ImgLoader from './children/ImgLoader/ImgLoader'\r\nimport {connect} from 'react-redux'\r\n    import { TextareaItem ,DatePicker,List ,Modal } from 'antd-mobile';\r\n\r\nfunction timestampToTime (timestamp) {\r\n    const dateObj = new Date(+timestamp) // ps, 必须是数字类型，不能是字符串, +运算符把字符串转化为数字，更兼容\r\n    const year = dateObj.getFullYear() // 获取年，\r\n    const month = dateObj.getMonth()  // 获取月，必须要加1，因为月份是从0开始计算的\r\n    const date = dateObj.getDate() // 获取日，记得区分getDay()方法是获取星期几的。\r\n    return year + '-' + month + '-' + date ;\r\n}\r\n\r\nconst alert = Modal.alert;\r\nconst showAlert = (title,content) => {\r\n    const alertInstance = alert(title, content, [\r\n      { text: '取消', onPress: () => console.log('cancel'), style: 'default' },\r\n      { text: '好的', onPress: () => console.log('ok') },\r\n    ]);\r\n  };\r\n\r\n\r\n  \r\n  const nowTimeStamp = Date.now();\r\n  const now = new Date(nowTimeStamp);\r\nconst jonners = [\r\n    {\r\n        name:'你的故事',\r\n        img:'/img/joinersImg/j1.png',\r\n    },\r\n    {\r\n        name:'drake your',\r\n        img:'/img/joinersImg/j2.png',\r\n    },\r\n    {\r\n        name:'渐变',\r\n        img:'/img/joinersImg/j3.png',\r\n    },\r\n    {\r\n        name:'一直往南',\r\n        img:'/img/joinersImg/j4.png',\r\n    },\r\n    {\r\n        name:'silence',\r\n        img:'/img/joinersImg/j5.png',\r\n    },\r\n    {\r\n        name:'JOJO',\r\n        img:'/img/joinersImg/j6.png',\r\n    },\r\n    {\r\n        name:'mengHi',\r\n        img:'/img/joinersImg/j7.png',\r\n    },\r\n    {\r\n        name:'福州猛',\r\n        img:'/img/joinersImg/j8.png',\r\n    },\r\n    {\r\n        name:'关关雎鸠',\r\n        img:'/img/joinersImg/j9.png',\r\n    },\r\n]\r\n  let id = Math.floor(Math.random()*100000000);\r\n  let viewNum = Math.floor(Math.random()*1000);\r\n  let joinerNum = Math.floor(Math.random()*8+2);\r\n  let commentNum = Math.floor(Math.random()*100);\r\nexport class NewTravel extends Component {\r\n    constructor(props){\r\n        super(props)\r\n        this.state={\r\n            date: now,\r\n        }\r\n    }\r\n    SmtAction(){\r\n        console.log();\r\n        \r\n        if(!this.imgLoader.state.files[0]){\r\n            showAlert('图片','我们找不到图片呢');\r\n            return;\r\n        }\r\n        if(!this.autoFocusInst.state.value){\r\n            showAlert('地点','我们找不到地点呢');\r\n            return;\r\n        }\r\n        if(!this.customFocusInst.state.value){\r\n            showAlert('描述','我们找不到描述呢');\r\n            return;\r\n        }\r\n        if(this.state.date=== now){\r\n            showAlert('时间','你确定时间没错吗');\r\n            return;\r\n        }\r\n        this.props.addNewTravel(\r\n            {\r\n                id:id,\r\n                username:this.props.userInfo.name,\r\n                userImg:this.props.userInfo.img,\r\n                releaseTime:timestampToTime(Number(this.state.date)),\r\n                title:this.autoFocusInst.state.value,\r\n                img:this.imgLoader.state.files[0].url,\r\n                views:viewNum,\r\n                numOfJoin:joinerNum,\r\n                commentNum:commentNum,\r\n                joiner:jonners.slice(joinerNum),\r\n            }\r\n        );\r\n        this.props.history.goBack();\r\n    }\r\n    getImgUrl(){\r\n        // return this.state.file[0].url\r\n        \r\n    }\r\n    render() {\r\n        return (\r\n            <div className=\"newTravel page subpage\">\r\n                <HeaderBack {...this.props}/>\r\n                <div className=\"newTravelContent\">\r\n\r\n                    <div className=\"imgLoaderBox\">\r\n                        <ImgLoader ref={el => this.imgLoader = el} getImgUrl className=\"imgLoader\"/>\r\n                    </div>\r\n                    <TextareaItem\r\n                        title=\"地点\"\r\n                        placeholder=\"填写旅行的 标题\"\r\n                        data-seed=\"logId\"\r\n                        ref={el => this.autoFocusInst = el}\r\n                        autoHeight\r\n                        rows={1}\r\n                        count={15}\r\n                    />\r\n                    <hr/>\r\n                    <TextareaItem\r\n                        title=\"描述\"\r\n                        placeholder=\"去旅行的感想和相对大家说的话\"\r\n                        data-seed=\"logId\"\r\n                        autoHeight\r\n                        rows={4}\r\n                        // count={60}\r\n                        ref={el => this.customFocusInst = el}\r\n                    />\r\n\r\n                    <DatePicker\r\n                        minDate={new Date(nowTimeStamp)}\r\n                        mode='date'\r\n                        value={this.state.date}\r\n                        onChange={date => this.setState({ date })}\r\n                        >\r\n                        <List.Item arrow=\"horizontal\">时间</List.Item>\r\n                    </DatePicker>\r\n                    {/* <PickerView\r\n                    data={province}\r\n                    value={['02', '02-1', '02-1-1']}\r\n                    /> */}\r\n\r\n\r\n                    <p className=\"newTravelSMT\"  onClick={this.SmtAction.bind(this)}>发布</p>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nconst mapStateToPrpps = (state)=>{\r\n    return{\r\n        userInfo:state.user\r\n    }\r\n  }\r\n  \r\n  const mapDispatchToProps = (dispatch)=>{\r\n    return{\r\n        addNewTravel(data){\r\n            dispatch({\r\n                type:'addNewTravel',\r\n                data:data\r\n            });\r\n          }\r\n    }\r\n  }\r\n\r\nexport default connect(mapStateToPrpps,mapDispatchToProps)(NewTravel);\r\n\r\n\r\n\r\n","import React, { Component } from 'react';\r\nimport './style.scss'\r\nexport class HeaderBack extends Component {\r\n    \r\n    render() {\r\n        return (\r\n            <div className=\"headerBack\" >\r\n                <span className=\"iconfont icon-Left\" onClick={this.props.history.goBack}></span>\r\n                <img src=\"/img/logo.png\" alt=\"\"/>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default HeaderBack;\r\n"],"sourceRoot":""}